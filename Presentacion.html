<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Modelado de Variables Demográficas Mediante Algoritmos de Aprendizaje Supervisado</title>
    <meta charset="utf-8" />
    <meta name="author" content="Facundo Morini, Mateo Pérez, Ignacio Tarigo" />
    <script src="Presentacion_files/header-attrs-2.28/header-attrs.js"></script>
    <link href="Presentacion_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="Presentacion_files/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <script src="Presentacion_files/kePrint-0.0.1/kePrint.js"></script>
    <link href="Presentacion_files/lightable-0.0.1/lightable.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: right, top, my-title, title-slide

.title[
# Modelado de Variables Demográficas Mediante Algoritmos de Aprendizaje Supervisado
]
.subtitle[
## Aprendizaje Estadístico Supervisado 2024
]
.author[
### Facundo Morini, Mateo Pérez, Ignacio Tarigo
]
.date[
### Diciembre 2024
]

---


&lt;style type="text/css"&gt;
body {
  font-family: 'Roboto', sans-serif; 
}

h1 {
  color: #005F8D; 
  font-size:  2.2em !important; 
  text-align: center; 
  margin-bottom: 30px !important; 
  text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3); 
  font-weight: bold; 
}

h2 {
 color: #005F8D; 
  font-size: 2em !important; 
  text-align: center; 
  margin-bottom: 30px !important; 
  text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3); 
  letter-spacing: 2px; 
  font-weight: bold; 
}

h3 {
  color: #2980B9; 
  font-size: 1.4em;
  font-weight: normal;
}

p {
  font-size: 1em; 
  line-height: 1.3;
  color: #333333; 
}

&lt;/style&gt;




# Introducción

Cuando se trabaja con *modelos basados en agentes* en el ámbito demográfico como el modelado de la tasa especifica de fecundidad (ASFR), es usual modelar o hacer cierto supuestos sobre la edad en que las mujeres comienzan a estar en riesgo de concebir.

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="figs_pres/ASFR.png" alt="Ejemplo de tasa especifica de fecundidad (ASFR)" width="50%" /&gt;
&lt;p class="caption"&gt;Ejemplo de tasa especifica de fecundidad (ASFR)&lt;/p&gt;
&lt;/div&gt;
---

# Introducción

Es por esto que en este trabajo nos interesa evaluar el desempeño de modelos de aprendizaje supervisado en dos objetivos:  
  
- **Predecir la edad al primer hijo de las mujeres**.  
  
- **Clasificar si una mujer comienza su vida sexual antes o después de los 18 años**.  
  
En ambos casos, se emplearán variables socioeconómicas y comportamentales de las mujeres como predictores. En parte al gran numero de datos disponibles se priorizará el uso de modelos basados en árboles de decisión, como métodos de Bagging o Boosting.

Los datos provienen de las *encuestas DHS* (Programa de Encuestas Demográficas y de Salud), realizadas principalmente en países en desarrollo. Se analizarán las rondas VI y VII, llevadas a cabo entre 2010 y 2020 en varios países.

El programa, gestionado y financiado por la Agencia de los Estados Unidos para el Desarrollo Internacional (USAID), recopila y difunde datos representativos a nivel nacional sobre salud y población.

---

# Descripción de los datos

Se seleccionó un grupo de países representativos de distintas regiones, asegurando un período de tiempo similar y la disponibilidad de variables clave en todas las encuestas. 
  
Se eligieron los siguientes países:  

- América Latina y el Caribe: Perú, Guatemala y República Dominicana.  
- Europa del este: Albania y Armenia.  
- Norte y Sur de África: Etiopía y Sudáfrica.  

El análisis incluye aproximadamente 105.000 observaciones de mujeres entre 15 y 64 años y se centra en 30 variables comunes consideradas relevantes.


---

# Descripción de los datos

&lt;table class="table" style="font-size: 12px; color: black; margin-left: auto; margin-right: auto;"&gt;
&lt;caption style="font-size: initial !important;"&gt;Descripción de las variables disponibles en el trabajo.&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Codigo DHS &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Nombre &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Descripción &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Tipo &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Recorrido &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; caseid &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; id &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Identificador de la mujer encuestada &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 104487 Mujeres &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v000 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; pais &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; País donde se realizó la encuesta &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 7 Paises &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v005 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; ponderador &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Peso de la mujer en la encuesta, número entero de 8 dígitos, donde 6 dígitos corresponden a decimales &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numérica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v007 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; anio &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Año en que se realizó la encuesta &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numérica Discreta &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 2008-2018 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v012 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; edad &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Edad de la mujer encuestada &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numérica Discreta &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 15-59 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v021 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; psu &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Unidad primaria de muestreo &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numérica Discreta &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v022 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; estrato &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Estrato del que se obtuvo la observación &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v025 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; zona &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Indica si la mujer es de un área urbana o rural &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 1:Urbano, 2:Rural &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v119 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; hogar_elect &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Indica si el hogar tiene acceso a electricidad &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 0:No, 1:Si &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v121 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; hogar_tv &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Indica si el hogar dispone de una televisión &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 0:No, 1:Si &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v133 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; anio_educ &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Total de años de educación de la mujer, calculado a partir del nivel máximo de educación alcanzado; es un valor comparable entre países &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numérica Discreta &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 0-25 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v136 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; n_fam_hogar &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Total de personas que viven en el hogar &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numérica Discreta &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 1-25 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v157 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; leer &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Frecuencia con la que la mujer lee un periódico, revista o libro &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 0:Nada, 1:Ocasional, 2:Todos los días &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v158 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; radio &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Frecuencia con la que la mujer escucha la radio &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 0:Nada, 1:Ocasional, 2:Todos los días &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v159 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; noticias &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Frecuencia con la que la mujer ve noticias &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 0:Nada, 1:Ocasional, 2:Todos los días &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Descripción de los datos

&lt;table class="table" style="font-size: 10px; color: black; margin-left: auto; margin-right: auto;"&gt;
&lt;caption style="font-size: initial !important;"&gt;Descripción de las variables disponibles en el trabajo.&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Codigo DHS &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Nombre &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Descripción &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Tipo &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Recorrido &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v190 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; cat_riqueza &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Categoría de riqueza del hogar &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 1:Más Pobre, 2:Pobre, 3:Medio, 4:Rico, 5:Más Rico &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v191 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; indice_riqueza &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Índice de riqueza del hogar estandarizado, calculado a partir de distintas medidas como materiales de construcción de la casa y servicios disponibles; 5 dígitos corresponden a decimales &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numérica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; -4.992-3.09962 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v212 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; edad_phijo &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Edad de la mujer al primer hijo &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numérica Discreta &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 3-47 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v301 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; con_antic &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Conocimiento de algún método anticonceptivo, donde se distingue entre modernos (ej.: condón, pastillas, parches, etc.), tradicionales (ej.: coito interrumpido, calendario, etc.) y folklóricos (ej.: amuletos, rituales, etc.) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 0: Ninguno, 1:Folklórico, 2:Tradicional, 3:Moderno &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v364 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; uso_antic &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Intención de uso de métodos anticonceptivos &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 1:Usando Método, 2:No Usando Método, 3:Nunca Tiene Relaciones &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v503 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; cant_uniones &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Cantidad de uniones que ha tenido la mujer &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 0: No casada, 1: Una unión, 2: Más de una unión &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v531 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; edad_psexo &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Edad de la mujer al primer acto sexual &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numérica Discreta &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 0-45 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v536 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; rec_sexo &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Relaciones sexuales recientes de la mujer &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 0: Nunca, 1: Activa, 2: No activa &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v613 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; nideal_hijos &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Número ideal de hijos &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numérica Discreta &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 0-30 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v715 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; anio_educ_par &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Total de años de educación de la pareja de la mujer &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numérica Discreta &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 0-24 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v717 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; ocupacion &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Ocupación de la mujer &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Categórica &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 0: No Trabaja, 1: Profesional/Técnico, 2: Agricultura, 3: Servicios/Ventas, 4: Doméstico, 5: Manual &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 4.5em; "&gt; v836 &lt;/td&gt;
   &lt;td style="text-align:left;width: 4.5em; "&gt; n_parejas &lt;/td&gt;
   &lt;td style="text-align:left;width: 26em; "&gt; Cantidad de parejas sexuales que ha tenido la mujer &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Numérica Discreta &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; "&gt; 1-95 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Descripción de los datos

Los datos provienen de una muestra compleja con un diseño muestral **estratificado por conglomerados en dos etapas**, representativo a nivel nacional, regional, y urbano-rural.

Aunque este diseño debería incorporarse en los modelos para una mejor representación poblacional, en modelos como Random Forest no existe bibliografía ampliamente desarrollada al respecto. Por ello, en esta primera aproximación **NO** se incorpora explícitamente, aunque sí se considera en el análisis exploratorio para comprender mejor la estructura y distribución de los datos.

A su vez el análisis exploratorio teniendo en cuenta el diseño o no, dio resultados muy similares con lo que la muestra en principio es "representativa" de la población.

---

# Edad al primer hijo

La edad en que las mujeres comienzan a tener hijos está influenciada por factores sociales, económicos y culturales. La bibliografía destaca elementos fuertemente vinculados a la fecundidad, como la participación laboral femenina, el acceso a la educación, la planificación familiar y el uso de métodos anticonceptivos.



&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/phijo_xpais -1.png" alt="Gráfico violín, distribución de la edad al primer hijo por país."  /&gt;
&lt;p class="caption"&gt;Gráfico violín, distribución de la edad al primer hijo por país.&lt;/p&gt;
&lt;/div&gt;


---

# Edad al primer hijo

&lt;table class="table" style="font-size: 15px; color: black; margin-left: auto; margin-right: auto;"&gt;
&lt;caption style="font-size: initial !important;"&gt;Media y Desvio Estimados de la Edad al Primer Hijo por país&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; País &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Media Edad &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Desvio &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 20em; "&gt; Etiopia &lt;/td&gt;
   &lt;td style="text-align:center;width: 5em; "&gt; 18.84 &lt;/td&gt;
   &lt;td style="text-align:center;width: 5em; "&gt; 0.08 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 20em; "&gt; Guatemala &lt;/td&gt;
   &lt;td style="text-align:center;width: 5em; "&gt; 19.60 &lt;/td&gt;
   &lt;td style="text-align:center;width: 5em; "&gt; 0.04 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 20em; "&gt; República Dominicana &lt;/td&gt;
   &lt;td style="text-align:center;width: 5em; "&gt; 20.11 &lt;/td&gt;
   &lt;td style="text-align:center;width: 5em; "&gt; 0.10 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 20em; "&gt; Perú &lt;/td&gt;
   &lt;td style="text-align:center;width: 5em; "&gt; 20.65 &lt;/td&gt;
   &lt;td style="text-align:center;width: 5em; "&gt; 0.09 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 20em; "&gt; Sudáfrica &lt;/td&gt;
   &lt;td style="text-align:center;width: 5em; "&gt; 20.95 &lt;/td&gt;
   &lt;td style="text-align:center;width: 5em; "&gt; 0.13 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 20em; "&gt; Armenia &lt;/td&gt;
   &lt;td style="text-align:center;width: 5em; "&gt; 21.87 &lt;/td&gt;
   &lt;td style="text-align:center;width: 5em; "&gt; 0.07 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 20em; "&gt; Albania &lt;/td&gt;
   &lt;td style="text-align:center;width: 5em; "&gt; 22.84 &lt;/td&gt;
   &lt;td style="text-align:center;width: 5em; "&gt; 0.07 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Edad al primer hijo

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/edu_att -1.png" alt="Gráfico Densidad, edad al primer hijo por Años de Educación de la Madre."  /&gt;
&lt;p class="caption"&gt;Gráfico Densidad, edad al primer hijo por Años de Educación de la Madre.&lt;/p&gt;
&lt;/div&gt;

---

# Edad al primer hijo

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/edu_att_xpais -1.png" alt="Gráfico Caja, distribución de la edad al primer hijo por país y si la mujer tiene más de 15 años de educación."  /&gt;
&lt;p class="caption"&gt;Gráfico Caja, distribución de la edad al primer hijo por país y si la mujer tiene más de 15 años de educación.&lt;/p&gt;
&lt;/div&gt;

---

# Edad al primer hijo

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/riqueza_xpais -1.png" alt="Gráfico Densidad, distribución de la edad al primer hijo por riqueza del hogar."  /&gt;
&lt;p class="caption"&gt;Gráfico Densidad, distribución de la edad al primer hijo por riqueza del hogar.&lt;/p&gt;
&lt;/div&gt;

---

# Primera relación sexual

La edad de inicio de las relaciones sexuales marca el inicio del riesgo de concebir y está estrechamente relacionada con la edad al primer hijo. Factores comportamentales, económicos y educativos relevantes para la edad al primer hijo también influyen en esta variable. En este análisis, se considerará si la mujer inicia su vida sexual antes o después de los 18 años.



&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/psexo_xpais -1.png" alt="Gráfico barras, Estimación de la proporción de mujeres que comienzan a tener relaciones sexuales antes de los 18 años por país."  /&gt;
&lt;p class="caption"&gt;Gráfico barras, Estimación de la proporción de mujeres que comienzan a tener relaciones sexuales antes de los 18 años por país.&lt;/p&gt;
&lt;/div&gt;

---

# Primera relación sexual

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/edu_att_clas-1.png" alt="Gráfico de caja, distribución de años de educación de la mujer por comienzo de relaciones sexuales."  /&gt;
&lt;p class="caption"&gt;Gráfico de caja, distribución de años de educación de la mujer por comienzo de relaciones sexuales.&lt;/p&gt;
&lt;/div&gt;

---

# Primera relación sexual

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/psexo_xcat_riqueza -1.png" alt="Gráfico barras, Estimación de la proporción de mujeres que comienzan a tener relaciones sexuales antes de los 18 años por categría de riqueza."  /&gt;
&lt;p class="caption"&gt;Gráfico barras, Estimación de la proporción de mujeres que comienzan a tener relaciones sexuales antes de los 18 años por categría de riqueza.&lt;/p&gt;
&lt;/div&gt;

---

# Primera relación sexual

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/psexo_xtv -1.png" alt="Gráfico barras, Estimación de la proporción de mujeres que comienzan a tener relaciones sexuales antes de los 18 años por si poseen o no un televisor en su hogar."  /&gt;
&lt;p class="caption"&gt;Gráfico barras, Estimación de la proporción de mujeres que comienzan a tener relaciones sexuales antes de los 18 años por si poseen o no un televisor en su hogar.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad al primer hijo
## Filtrado de variables

En esta primera aproximación al problema se opta por solamente tomar las observaciones que dispongan de todos los datos necesarios para el modelo, no realizándose imputaciones de datos faltantes o análisis de la no respuesta a la encuesta.

En total se utilizan **46029 observaciones** de mujeres donde se utilizara un 85% de los datos para entrenar y el 15% restante para evaluar los modelos considerados.

En esta división se tendrá en cuenta el país de origen de la mujer para que no haya un desbalance de muchas observaciones de algún país en particular.  

Casos extremos: Ejemplo: Se consideran únicamente las mujeres que tuvieron su primer hijo a partir de los 11 años, límite establecido con base en criterios biológicos.

---

# Modelado de la edad al primer hijo
## Selección   de   covariables   relevantes

Antes de seleccionar las variables para el modelo, se excluyen aquellas que carecen de sentido práctico. Por ejemplo:
- la edad de la mujer
- la edad a la primera relación sexual 

Paso previo: análisis de importancia de las variables. Para esto se utiliza un modelo de *Random Forest* donde se utiliza el método de permutación para calcular la importancia de las variables:
- grilla de 30 combinaciones posibles de la cantidad de variables a considerar en cada nodo (*mtry*)
- cantidad mínima de observaciones en cada nodo terminal (*min_n*)
- *10-fold cross-validation* para evaluar los modelos. Se seleccionó el mejor modelo en base a la métrica de raíz del error cuadrático medio.

---

# Modelado de la edad al primer hijo
## Selección de covariables relevantes





&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/vip_phijo -1.png" alt="Gráfico barras, importancia de las variables consideradas en el modelo de Random Forest mediante permutación para predecir la edad al primer hijo."  /&gt;
&lt;p class="caption"&gt;Gráfico barras, importancia de las variables consideradas en el modelo de Random Forest mediante permutación para predecir la edad al primer hijo.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad al primer hijo
## Selección de covariables relevantes

En este caso las variables que quedaron seleccionadas son:

1.  Años de educación de la mujer.
2.  País de procedencia de la mujer.
3.  Índice de riqueza del hogar.
4.  Cantidad de uniones que ha tenido la mujer.
5.  Años de educación de la pareja de la mujer.
6.  Si el hogar dispone de televisión.
7.  Categoría de riqueza del hogar.
8.  Numero de parejas sexuales que ha tenido la mujer.
9.  Numero ideal de hijos.
10. Numero de personas que viven en el hogar.


---

# Modelado de la edad al primer hijo
## Modelos utilizados

Dada la gran cantidad de observaciones y que se tiene un gran numero de variables categóricas, se opta por utilizar modelos principalmente basados en árboles de decisión, en este caso se entrenarán los siguientes modelos:

- **Bagging**

- **Random Forest**

- **XGBoost**

Se realiza el tuneo de hiperparámetros para cada modelo, donde al final se toma el que presente la mejor *performance* para realizar el posterior análisis.

---

# Modelado de la edad al primer hijo
## Búsqueda de Hiperparámetros
### Bagging

Se procede a la búsqueda de hiperparámetros para los modelos en busca del modelo que presente la mejor *performance*. Para esto se crea una grilla específica para cada uno, evaluando todos los modelos en conjunto mediante *workflow_map*.

Se entrenaron:
- cantidad mínima de observaciones en cada nodo terminal (*min_n*)
- cantidad de árboles (*trees*)

&lt;table class="table" style="font-size: 8px; color: black; margin-left: auto; margin-right: auto;"&gt;
&lt;caption style="font-size: initial !important;"&gt;Grilla de hiperparámetros para modelos de Bagging&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; min_n &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 50 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 100 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 150 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 200 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 250 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 300 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 350 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 400 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 450 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 500 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1500 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2500 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; trees &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 50 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 100 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 500 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---

# Modelado de la edad al primer hijo
## Búsqueda de Hiperparámetros
### Bagging



&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/tune_bagging_phijo -1.png" alt="Gráfico, resultados de la búsqueda de hiperparámetros para modelos de Bagging."  /&gt;
&lt;p class="caption"&gt;Gráfico, resultados de la búsqueda de hiperparámetros para modelos de Bagging.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad al primer hijo
## Búsqueda de Hiperparámetros
### Random Forest

Se entrenaron:
- cantidad mínima de observaciones en cada nodo terminal (*min_n*)
- cantidad de variables a considerar en cada nodo (*mtry*)
- cantidad de árboles (*trees*)


&lt;table class="table" style="font-size: 8px; color: black; margin-left: auto; margin-right: auto;"&gt;
&lt;caption style="font-size: initial !important;"&gt;Grilla de hiperparámetros para modelos de Random Forest&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; min_n &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 50 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 100 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 150 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 200 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 250 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 300 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 350 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 400 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 450 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 500 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1500 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2500 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; trees &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 50 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 100 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 500 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; mtry &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Modelado de la edad al primer hijo
## Búsqueda de Hiperparámetros
### Random Forest

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/tune_rf_phijo -1.png" alt="Gráfico, resultados de la búsqueda de hiperparámetros para modelos de Random Forest."  /&gt;
&lt;p class="caption"&gt;Gráfico, resultados de la búsqueda de hiperparámetros para modelos de Random Forest.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad al primer hijo
## Búsqueda de Hiperparámetros
### XGBoost

No se definió una grilla fija, se utilizó el método de búsqueda *Latin hypercube sampling*:

- evalúa un espacio de hiperparámetros de forma más eficiente
- se evaluaron un total de 60 combinaciones posibles de hiperparámetros
- antes de la evaluación final se realizó una exploración para limitar el rango de los hiperparámetros que influían en mayor medida en la *performance* del modelo. Principalmente el *learning rate*.

&lt;table class="table" style="font-size: 10px; color: black; margin-left: auto; margin-right: auto;"&gt;
&lt;caption style="font-size: initial !important;"&gt;Grilla rango hiperparámetros para modelos de XGBoost&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Valor min. &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Valor max. &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; tree_depth &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 15 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; min_n &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 50 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 500 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; loss_reduction &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1e-10 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 31 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; sample_size &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1.0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; mtry &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 10 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; learn_rate &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.0016 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 0.1600 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Modelado de la edad al primer hijo
## Búsqueda de Hiperparámetros
### Resultados
La búsqueda se realiza al igual que para el modelo de visualización de importancias mediante *10-fold cross-validation*. En las figuras se puede visualizar los valores de *RMSE* y *RSQ* para los modelos de *Bagging* y *Random Forest* respectivamente. En ambos gráficos parece bastante marcado una mejor *performance* para valores de *min_n* cercano a los `\(400\)`, pareciendo la grilla propuesta adecuada para este problema.

---

# Modelado de la edad al primer hijo
## Comparación de modelos

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/comp_modelos_phijo -1.png" alt="Gráfico comparación de los modelos de Bagging, Random Forest y XGBoost para predecir la edad al primer hijo."  /&gt;
&lt;p class="caption"&gt;Gráfico comparación de los modelos de Bagging, Random Forest y XGBoost para predecir la edad al primer hijo.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad al primer hijo
## Comparación de modelos

Metrica comparación:
`\(RMSE = \sqrt{\frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2}\)`

- El modelo ajustado por el método de **Random Forest** es el que tiene un valor más bajo del RMSE
- Los tres valores son muy cercanos entre sí, por lo cual sugiere que el rendimiento de los modelos es muy similar. - Esto se puede deber a que los tres son basados en árboles, entonces, por más que haya diferencias en la metodología, a grandes rasgos deberían predecir de forma similar.

---

# Modelado de la edad al primer hijo
## Evaluación modelo final
### Análisis de los Residuos - Conjunto de Entrenamiento

Modelo Final: **Random Forest**



&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/res_modelo_phijo -1.png" alt="Gráfico residuos vs predichos, conjunto de entrenamiento."  /&gt;
&lt;p class="caption"&gt;Gráfico residuos vs predichos, conjunto de entrenamiento.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad al primer hijo
## Evaluación modelo final
### Análisis de los Residuos - Conjunto de Entrenamiento

- No se observa un patrón en la nube de puntos 
- El rango de predicción del modelo no es del todo satisfactorio, contemplando solo entre los 17 a 27 años. (Se probo diferentes maneras de solucionar este problema como transformaciones de la variable de interes)
- Aparición de algunos valores atípicos de los residuos en la parte negativa del gráfico (el modelo no logra estimar bien la edad a la que las mujeres realmente tuvieron su primer hijo para valores más altos)
- Los puntos segmentados por país presentan aproximadamente el mismo comportamiento (a simple vista pareciera no existir ningún país que erre mas que en otros)

---

# Modelado de la edad al primer hijo
## Evaluación modelo final

- El *RMSE* del modelo para cada país es muy similar al resto
- `\(MAPE = \frac{1}{n} \sum_{i=1}^{n} \left| \frac{y_i - \hat{y}_i}{y_i} \right| \times 100\)`
- Indica la media del error porcentual de todas las observaciones de cada país
- Muy parecida para todos los países, y no indican que ningún país prediga muy mal la variable a explicar

&lt;table class="table" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;"&gt;
&lt;caption style="font-size: initial !important;"&gt;Métricas en el conjunto de testeo&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; pais &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; rmse &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; mape &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Albania &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.82 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12.05 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Armenia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.82 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Etiopia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.46 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.04 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Guatemala &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.58 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13.46 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Perú &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.67 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13.39 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; República Dominicana &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.69 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.27 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Sudáfrica &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.67 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13.82 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Modelado de la edad al primer hijo
## Interpretación e importancia de las variables

Resultados muy similares a los obtenidos en el anterior ejemplo y el análisis exploratorio, siendo las variables años de educación y país de la mujer las variables con más importancia.

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/vip_fit_phijo -1.png" alt="Gráfico barras, importancia de las variables consideradas en el modelo final."  /&gt;
&lt;p class="caption"&gt;Gráfico barras, importancia de las variables consideradas en el modelo final.&lt;/p&gt;
&lt;/div&gt;





---

# Modelado de la edad al primer hijo
## Interpretación e importancia de las variables
### Gráfico de Dependencia Parcial - Años de educación

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/pdp_educ -1.png" alt="Gráfico PDP, efecto de los años de educación en la edad al primer hijo."  /&gt;
&lt;p class="caption"&gt;Gráfico PDP, efecto de los años de educación en la edad al primer hijo.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad al primer hijo
## Interpretación e importancia de las variables
### Gráfico de Dependencia Parcial - Años de educación

- Efecto marginal que tiene la variable de años de educación de la madre con respecto a la variable de interés del problema planteado.
- La edad media de la mujer a la hora de tener su primer hijo en mujeres que tienen 10 o menos años de educación permanece constante entre los 19 y 20 años
- Luego de los 10 años de educación, la edad media de la mujer al tener su primer hijo crece de forma abrupta por cada año extra de educación que tiene la mujer.

---

# Modelado de la edad al primer hijo
## Interpretación e importancia de las variables
### Gráfico de Dependencia Parcial - País

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/pdp_pais -1.png" alt="Gráfico PDP, efecto del país en la edad al primer hijo."  /&gt;
&lt;p class="caption"&gt;Gráfico PDP, efecto del país en la edad al primer hijo.&lt;/p&gt;
&lt;/div&gt;
---

# Modelado de la edad al primer hijo
## Interpretación e importancia de las variables
### Gráfico de Dependencia Parcial - País

- Efecto marginal de la variable de país sobre la variable de interés.
- Similar al análisis exploratorio: países europeos tienen la edad media de la mujer al tener su primer hijo un poco más alta que el resto.

---

# Modelado de la edad a la primera relación sexual

- Modelado de la edad a la primera relación sexual. Interesa predecir la proporción de mujeres que comienzan a tener relaciones sexuales antes de los 18 años en algunos países.
- Se creó otra variable que combine el país y la variable de interés, para que en el proceso de división de los datos o el remuestreo no haya un desbalance.
- Se trabajó con observaciones que disponen de todos los datos necesarios para el modelo
- Se construyó la variable de interés a partir de la variable *edad_psexo*
- Se filtraron observaciones con valores extremadamente atípicos o que podrían carecer de sentido, en este caso se toma como límite inferior de la edad a la primera relación sexual los 9 años
- Se dispone de **49349 observaciones** donde nuevamente se utilizará un 85% de los datos para entrenar y el 15% restante para evaluar los modelos considerados.
- Nuevamente se utilizó un modelo de *Random Forest* para seleccionar las variables más relevantes para el problema.





---

# Modelado de la edad a la primera relación sexual
## Selección de covariables relevantes

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/vip_psexo -1.png" alt="Gráfico barras, importancia de las variables consideradas en el modelo de Random Forest mediante permutación para predecir si comienza a tener relaciones luego de los 18 años."  /&gt;
&lt;p class="caption"&gt;Gráfico barras, importancia de las variables consideradas en el modelo de Random Forest mediante permutación para predecir si comienza a tener relaciones luego de los 18 años.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad a la primera relación sexual
## Selección de covariables relevantes

Una vez visualizados los datos y las posibles relaciones entre las variables se procede a armar los modelos. De lo visto, mediante el modelo de *Random Forest*, se seleccionan las *10* variables que más importancia presentaron para clasificar si una mujer comienza su vida sexual antes o después de los 18 años.

En este caso las variables que quedaron seleccionadas son:

1.  Años de educación de la mujer.
2.  País de procedencia de la mujer.
3.  Índice de riqueza del hogar.
4.  Numero de parejas sexuales que ha tenido la mujer.
5.  Años de educación de la pareja de la mujer.
6.  Cantidad de uniones que ha tenido la mujer.
7.  Si el hogar dispone de televisión.
8.  Categoría de riqueza del hogar.
9.  La frecuencia con la que la mujer ve las noticias.
10. Si el hogar tiene acceso a electricidad.

---

# Modelado de la edad a la primera relación sexual
## Modelos Utilizados y Búsqueda de Hiperparámetros

En esta ocasión se propone el uso de modelos basados en árboles: *Bagging* y *Random Forest*. Además, se ajusto un modelo de regresión logística para evaluar si los resultados obtenidos por métodos de árboles o un método mas clásico como la logística difieren en su *performance* en este problema.

Se realiza el tuneo de hiperparámetros para cada modelo, donde al final se toma el que presente la mejor *performance* para realizar el posterior análisis. En este caso las grillas utilizadas son las mismas que se utilizaron en el caso anterior. Se evalua en este caso la métrica de área bajo la curva *ROC*.

---

# Modelado de la edad a la primera relación sexual
## Búsqueda de Hiperparámetros



&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/tune_bagging_psexo -1.png" alt="Gráfico, resultados de la búsqueda de hiperparámetros para modelos de Bagging."  /&gt;
&lt;p class="caption"&gt;Gráfico, resultados de la búsqueda de hiperparámetros para modelos de Bagging.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad a la primera relación sexual
## Búsqueda de Hiperparámetros

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/tune_rf_psexo -1.png" alt="Gráfico, resultados de la búsqueda de hiperparámetros para modelos de Random Forest."  /&gt;
&lt;p class="caption"&gt;Gráfico, resultados de la búsqueda de hiperparámetros para modelos de Random Forest.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad a la primera relación sexual
## Comparación de modelos



&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/comp_modelos_psexo -1.png" alt="Gráfico comparación de los modelos de Bagging, Random Forest y Regresión Logística, mediante validación cruzada."  /&gt;
&lt;p class="caption"&gt;Gráfico comparación de los modelos de Bagging, Random Forest y Regresión Logística, mediante validación cruzada.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad a la primera relación sexual
## Comparación de modelos



Tambien podemos visualizar los rendimientos de los modelos mediante las curvas *ROC*. En este caso tambien se observa como los modelos de *RF* y *Bagging* presentan una *performance* algo superior a la regresión logística.

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/comp_roc_psexo -1.png" alt="Gráfico, comparación curvas ROC para los modelos considerados en el conjunto de testeo."  /&gt;
&lt;p class="caption"&gt;Gráfico, comparación curvas ROC para los modelos considerados en el conjunto de testeo.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad a la primera relación sexual
## Evalación modelo final



Matriz de confusión para el modelo de *Random Forest* en el conjunto de testeo. En este caso el rendimiento del modelo parece aceptable, donde está ciertamente balanceado en la cantidad de falsos positivos y falsos negativos. Aunque el mismo presenta un desempeño algo inferior en clasificar mujeres que comienzan su vida sexual antes de los 18 años.

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/conf_mat -1.png" alt="Matriz de confusión para el modelo de Random Forest en el conjunto de testeo."  /&gt;
&lt;p class="caption"&gt;Matriz de confusión para el modelo de Random Forest en el conjunto de testeo.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad a la primera relación sexual
## Evalación modelo final

A partir de la misma es posible calcular las métricas para evaluar el rendimiento del modelo, se puede observar en la siguiente tabla las métricas más importantes. En este caso la precisión del modelo supera por encima del 70% lo cual es un valor aceptable considerando el problema planteado. 

&lt;table class="table" style="font-size: 14px; color: black; margin-left: auto; margin-right: auto;"&gt;
&lt;caption style="font-size: initial !important;"&gt;Métricas en el conjunto de testeo&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Metrica &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Valor &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Accuracy &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.70 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Sensibilidad &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.75 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Especificidad &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.66 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

# Modelado de la edad a la primera relación sexual
## Interpretación de las variables





&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/pdp_educ_psexo -1.png" alt="Gráfico PDP, efecto de los años de educación en la probabilidad de comenzar a tener relaciones sexuales luego de los 18 años."  /&gt;
&lt;p class="caption"&gt;Gráfico PDP, efecto de los años de educación en la probabilidad de comenzar a tener relaciones sexuales luego de los 18 años.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad a la primera relación sexual
## Interpretación de las variables



&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/pdp_ind_riq_psexo -1.png" alt="Gráfico PDP, efecto del indice de riqueza en el hogar en la probabilidad de comenzar a tener relaciones sexuales luego de los 18 años."  /&gt;
&lt;p class="caption"&gt;Gráfico PDP, efecto del indice de riqueza en el hogar en la probabilidad de comenzar a tener relaciones sexuales luego de los 18 años.&lt;/p&gt;
&lt;/div&gt;

---

# Modelado de la edad a la primera relación sexual
## Interpretación de las variables



&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="Presentacion_files/figure-html/pdp_pais_psexo -1.png" alt="Gráfico PDP, efecto del pais de la mujer en la probabilidad de comenzar a tener relaciones sexuales luego de los 18 años."  /&gt;
&lt;p class="caption"&gt;Gráfico PDP, efecto del pais de la mujer en la probabilidad de comenzar a tener relaciones sexuales luego de los 18 años.&lt;/p&gt;
&lt;/div&gt;

---

# Comentarios Finales

Como se observo el resultado general de los modelos fue aceptable en ambos casos, teniendo en cuenta que las variables de interés son de naturaleza compleja y el error irreducible en este tipo de caso es elevado. En cuanto las mejoras posibles se debería considerar formas de mejorar la predicción en el caso de edad del primer hijo para mujeres de mayores edades algo que no se ha conseguido captar en este caso, algo que posiblemente se deba a que no se tengan covariables óptimas para captar este fenómeno.

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create();
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
